import pandas as pd

print("üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ...")
df = pd.read_csv("combined_epl_results.csv")

# ----------------------------
# 1. –í—ã–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ + Date
# ----------------------------
columns_to_keep = [
    # –î–∞—Ç–∞ –º–∞—Ç—á–∞
    'Date',

    # –ö–æ–º–∞–Ω–¥—ã
    'HomeTeam', 'AwayTeam',

    # –†–µ–∑—É–ª—å—Ç–∞—Ç –º–∞—Ç—á–∞
    'FTR',  # Full Time Result (H, D, A)

    # –ú–µ—Ç—Ä–∏–∫–∏ –ø–µ—Ä–≤–æ–≥–æ —Ç–∞–π–º–∞
    'HTHG', 'HTAG',  # –ì–æ–ª—ã
    'HS', 'AS',      # –£–¥–∞—Ä—ã
    'HST', 'AST',    # –£–¥–∞—Ä—ã –≤ —Å—Ç–≤–æ—Ä
    'HF', 'AF',      # –§–æ–ª—ã
    'HC', 'AC',      # –£–≥–ª–æ–≤—ã–µ
    'HY', 'AY',      # –ñ—ë–ª—Ç—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏
    'HR', 'AR',      # –ö—Ä–∞—Å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏

    # –ë—É–∫–º–µ–∫–µ—Ä—Å–∫–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (—Ç–æ–ª—å–∫–æ Bet365)
    'B365H', 'B365D', 'B365A'  # –ü–æ–±–µ–¥–∞ –¥–æ–º–∞—à–Ω–µ–π / –ù–∏—á—å—è / –ü–æ–±–µ–¥–∞ –≥–æ—Å—Ç–µ–π
]

# –§–∏–ª—å—Ç—Ä—É–µ–º –¥–∞—Ç–∞—Å–µ—Ç
df_filtered = df[columns_to_keep]

# ----------------------------
# 2. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞—Ç—É
# ----------------------------
df_filtered['Date'] = pd.to_datetime(df_filtered['Date'], errors='coerce')

# –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ ‚Äî –≤–∞–∂–Ω–æ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
df_filtered.sort_values(by='Date', inplace=True)
df_filtered.reset_index(drop=True, inplace=True)

# ----------------------------
# 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –≤—ã–≤–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ
# ----------------------------
print("\n‚úÖ –ö–æ–ª–æ–Ω–∫–∏ —É—Å–ø–µ—à–Ω–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã.")
print(f"üìä –†–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞: {df_filtered.shape}")
print("\nüìÖ –ü–µ—Ä–≤—ã–µ 2 —Å—Ç—Ä–æ–∫–∏:")
print(df_filtered[['Date', 'HomeTeam', 'AwayTeam', 'FTR']].head(2))

# ----------------------------
# 4. –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç
# ----------------------------
output_file = "processed_with_b365_data.csv"
df_filtered.to_csv(output_file, index=False)

print(f"\nüíæ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª: {output_file}")